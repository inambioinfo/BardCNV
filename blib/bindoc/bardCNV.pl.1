.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.32
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
.\" expand to `' in nroff, nothing in troff, for use with C<>.
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "BARDCNV 1"
.TH BARDCNV 1 "2013-11-26" "perl v5.8.8" "User Contributed Perl Documentation"
.SH "NAME"
bardCNV.pl \- given a file of heterozygous positions (in a normal diploid sample), set the parameters and solve for the states of a hidden Markov model to predict copy number state in a matched tumor sample.
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 2
\&  bardCNV.pl --normalbam <bam file from normal sample> --tumorbam <bam file from tumor> --ref <reference fasta> --hetfile <BED formatted file of positions heterozygous in the normal>
\&  bardCNV.pl --trio --mombam <bam file from mother's sample> --dadbam <bam file from father's sample> --childbam <bam file from child>
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
Using B\-allele frequencies within sequence from a tumor sample, and the depth of coverage of the tumor compared to normal sequencing read depth, bardCNV.pl predicts copy number (including the copy counts of both alleles) using an \s-1HMM\s0 trained on these two features.  The program requires a list of high-confidence sites which are believed to be diploid and heterozygous in the normal sample.  For these sites, the B\-allele frequency in the tumor sample helps bardCNV to pin down the ratio of the major to minor copy number allele, and thus helps to determine the overall ploidy, and optionally, the purity level of the tumor sample.
.SH "OPTIONS"
.IX Header "OPTIONS"
.IP "\fB\-\-help|\-\-manual\fR" 4
.IX Item "--help|--manual"
Display documentation.  One \f(CW\*(C`\-\-help\*(C'\fR gives a brief synopsis, \f(CW\*(C`\-h \-h\*(C'\fR shows
all options, \f(CW\*(C`\-\-manual\*(C'\fR provides complete documentation.
.IP "\fB\-\-normalbam\fR" 4
.IX Item "--normalbam"
Specify the path of a \s-1BAM\s0 file containing the aligned sequence data from the normal sample (required).
.IP "\fB\-\-tumorbam\fR" 4
.IX Item "--tumorbam"
Specify the path of a \s-1BAM\s0 file containing the aligned sequence data from the tumor sample (required).
.IP "\fB\-\-ref\fR" 4
.IX Item "--ref"
Specify the path of the reference fasta file to which reads from the \s-1BAM\s0 files are aligned (required).
.IP "\fB\-\-mindepth\fR" 4
.IX Item "--mindepth"
Specify the minimum total depth of coverage required to include a heterozygous site in the observables written to the observable file (default 0).
.IP "\fB\-\-minnormaldepth\fR" 4
.IX Item "--minnormaldepth"
Specify the minimum normal depth of coverage required to include a heterozygous site in the observables written to the observable file (default 0).
.IP "\fB\-\-mintumordepth\fR" 4
.IX Item "--mintumordepth"
Specify the minimum tumor depth of coverage required to include a heterozygous site in the observables written to the observable file (default 0).
.IP "\fB\-\-maxcopies\fR" 4
.IX Item "--maxcopies"
Specify the maximum total number of copies to use in the training step (limits memory and \s-1CPU\s0 usage) (default 12, maximum 16).
.IP "\fB\-\-transprob\fR" 4
.IX Item "--transprob"
Specify the starting value for the transition probability between different states (which is constrained to be the same for all inter-state transitions (default 0.0001).  To fix the transition probability so that it is not optimized using Baum\-Welch, use the \*(L"\-\-fixedtrans\*(R" option.
.IP "\fB\-\-fixedtrans\fR" 4
.IX Item "--fixedtrans"
Do not optimize the state transition probabilities using Baum\-Welch.  Often, allowing the transition probability to vary will result in overfitting of the model with an overly-large transition probability, allowing the introduction of small artifactual copy number changes to increase the likelihood of data that doesn't conform to the overly-simplistic Gaussian model.
.IP "\fB\-\-sigratio\fR" 4
.IX Item "--sigratio"
Specify the starting value for the standard deviation of the (Gaussian distributed) ratio of depth of coverage in the tumor sequence to depth of coverage in the normal sequence (default 3.00).
.IP "\fB\-\-contam\fR" 4
.IX Item "--contam"
Specify the percentage contamination of the tumor tissue which is estimated to actually be unaffected (default 0.01).
.IP "\fB\-\-optcontam\fR" 4
.IX Item "--optcontam"
Train the model for a range of contamination values, then output states for the optimal model at the optimal contamination.
.IP "\fB\-\-mincontam\fR" 4
.IX Item "--mincontam"
If using \-\-optcontam option, this is the minimum value of the contamination parameter to test (default 0.01).  Note: if any value less then 0.01 is specified, 0.01 will be used.
.IP "\fB\-\-maxcontam\fR" 4
.IX Item "--maxcontam"
If using \-\-optcontam option, this is the maximum value of the contamination parameter to test (default 0.50).  Note: if any value greater than 0.99 is specified, 0.99 will be used.
.IP "\fB\-\-male\fR" 4
.IX Item "--male"
Omit any chromosome containing the character \*(L"X\*(R" in the training step (this is because sites, at least in the non-PAR regions of X for a male, cannot be heterozygous.
.SH "AUTHOR"
.IX Header "AUTHOR"
.Vb 1
\& Nancy F. Hansen - nhansen@mail.nih.gov
.Ve
.SH "LEGAL"
.IX Header "LEGAL"
This software/database is \*(L"United States Government Work\*(R" under the terms of
the United States Copyright Act.  It was written as part of the authors'
official duties for the United States Government and thus cannot be
copyrighted.  This software/database is freely available to the public for
use without a copyright notice.  Restrictions cannot be placed on its present
or future use.
.PP
Although all reasonable efforts have been taken to ensure the accuracy and
reliability of the software and data, the National Human Genome Research
Institute (\s-1NHGRI\s0) and the U.S. Government does not and cannot warrant the
performance or results that may be obtained by using this software or data.
\&\s-1NHGRI\s0 and the U.S.  Government disclaims all warranties as to performance,
merchantability or fitness for any particular purpose.
.PP
In any work or product derived from this material, proper attribution of the
authors as the source of the software or data should be made, using \*(L"\s-1NHGRI\s0
Genome Technology Branch\*(R" as the citation.
